!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).ImageMasonryExample=t()}(this,function(){"use strict";var e=[{src:"images/a-small.jpg",width:400,height:300},{src:"images/b-small.jpg",width:400,height:300},{src:"images/c-small.jpg",width:300,height:400},{src:"images/d-small.jpg",width:300,height:400},{src:"images/e-small.jpg",width:300,height:400},{src:"images/f-small.jpg",width:400,height:300},{src:"images/g-small.jpg",width:400,height:300},{src:"images/h-small.jpg",width:300,height:400},{src:"images/i-small.jpg",width:300,height:400},{src:"images/j-small.jpg",width:833,height:250},{src:"images/k-small.jpg",width:400,height:300},{src:"images/l-small.jpg",width:300,height:400},{src:"images/m-small.jpg",width:400,height:300},{src:"images/n-small.jpg",width:400,height:300},{src:"images/o-small.jpg",width:400,height:300},{src:"images/p-small.jpg",width:300,height:400},{src:"images/q-small.jpg",width:400,height:300},{src:"images/r-small.jpg",width:400,height:300},{src:"images/s-small.jpg",width:400,height:200},{src:"images/t-small.jpg",width:400,height:300},{src:"images/u-small.jpg",width:400,height:300},{src:"images/v-small.jpg",width:400,height:300},{src:"images/w-small.jpg",width:300,height:400},{src:"images/x-small.jpg",width:833,height:250},{src:"images/y-small.jpg",width:400,height:300},{src:"images/z-small.jpg",width:300,height:400},{src:"images/zz-small.jpg",width:400,height:300}];function _(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}var v={single_source_shortest_paths:function(e,t,i){var n={},s={};s[t]=0;var r,a,o,c,d,h,l=new m(function(e){return e.cost});for(l.push({value:t,cost:0});l.size();)for(var g in a=(r=l.pop()).value,o=r.cost,c=e(a)||{})d=o+c[g],h=s[g],(void 0===s[g]||d<h)&&(s[g]=d,l.push({value:g,cost:d}),n[g]=a);if(void 0!==s[i])return n;var u=["Could not find a path from ",t," to ",i,"."].join("");throw new Error(u)},extract_shortest_path_from_predecessor_list:function(e,t){for(var i=[],n=t;n;)i.push(n),e[n],n=e[n];return i.reverse(),i},find_path:function(e,t,i){var n=v.single_source_shortest_paths(e,t,i);return v.extract_shortest_path_from_predecessor_list(n,i)}};function m(e){this.content=[],this.scoreFunction=e}function w(e){return Math.round(100*e+Number.EPSILON)/100}function y(e,t){return w(e/t)}function b(e,t,i){return function(e,t){return w(e/t)}(t-(e.length-1)*i,e.reduce(function(e,t){return e+t.ratio},0))}function z(e,t){if(e<420)return 2;var i=y(e,t)/.75;return Math.round(1.5*i)}function s(e){for(var t=0<arguments.length&&void 0!==e?e:{},i=t.images,d=t.containerWidth,h=t.targetHeight,n=t.padding,l=void 0===n?2:n,s=t.seekLimit,r=void 0===s?z:s,a=t.byRow,o=void 0!==a&&a,g=i.map(function(e,t){return function(s){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?_(r,!0).forEach(function(e){var t,i,n;t=s,n=r[i=e],i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):_(r).forEach(function(e){Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(r,e))})}return s}({},e,{index:t,ratio:y(e.width,e.height)})}),u=r(d,h),c=v.find_path(function(e){var t,i,n,s,r,a,o={};o[e=+e]=0;for(var c=e+1;c<g.length+1&&!(u<c-e);++c)o[""+c]=(t=e,i=c,n=d,s=h,r=l,void 0,a=b(g.slice(t,i),n,r),Math.pow(Math.abs(a-s),2));return o},"0",g.length),m=[],p=[],f=0;f<c.length;f++)c[f+1]&&function(){var s=g.slice(+c[f],+c[f+1]),r=f===c.length-2,a=b(s,d,l);s.forEach(function(e,t){var i,n;e.scaledWidth=(i=a,n=e.ratio,w(i*n)),e.scaledHeight=a,e.scaledWidthPc=w(e.scaledWidth/d*100),t===s.length-1&&(e.isLastInRow=!0),e.isLastRow=r,p.push(e)}),m.push(s)}();return o?m:p}function o(i){var n=i.target||i.srcElement;n.__resizeRAF__&&cancelAnimationFrame(n.__resizeRAF__),n.__resizeRAF__=requestAnimationFrame(function(){var t=n.__resizeTrigger__,e=t&&t.__resizeListeners__;e&&e.forEach(function(e){e.call(t,i)})})}m.prototype={push:function(e){this.content.push(e),this.bubbleUp(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return 0<this.content.length&&(this.content[0]=t,this.sinkDown(0)),e},remove:function(e){for(var t=this.content.length,i=0;i<t;i++)if(this.content[i]===e){var n=this.content.pop();return void(i!==t-1&&(this.content[i]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.bubbleUp(i):this.sinkDown(i)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(e){for(var t=this.content[e];0<e;){var i=Math.floor((e+1)/2)-1,n=this.content[i];if(!(this.scoreFunction(t)<this.scoreFunction(n)))break;this.content[i]=t,this.content[e]=n,e=i}},sinkDown:function(e){for(var t=this.content.length,i=this.content[e],n=this.scoreFunction(i);;){var s=2*(e+1),r=s-1,a=null;if(r<t){var o=this.content[r],c=this.scoreFunction(o);c<n&&(a=r)}if(s<t){var d=this.content[s];this.scoreFunction(d)<(null===a?n:c)&&(a=s)}if(null==a)break;this.content[e]=this.content[a],this.content[a]=i,e=a}}},void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52));function t(e,t){var i,n=this.document,s=n.attachEvent;if("undefined"!=typeof navigator&&(i=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/)),!e.__resizeListeners__)if(e.__resizeListeners__=[],s)(e.__resizeTrigger__=e).attachEvent("onresize",o);else{"static"===getComputedStyle(e).position&&(e.style.position="relative");var r=e.__resizeTrigger__=n.createElement("object");r.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),r.setAttribute("class","resize-sensor"),r.setAttribute("tabindex","-1"),r.__resizeElement__=e,r.onload=function(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",o)},r.type="text/html",i&&e.appendChild(r),r.data="about:blank",i||e.appendChild(r)}e.__resizeListeners__.push(t)}function i(e,t){var i=document.attachEvent,n=e.__resizeListeners__||[];if(t){var s=n.indexOf(t);-1!==s&&n.splice(s,1)}else n=e.__resizeListeners__=[];if(!n.length){if(i)e.detachEvent("onresize",o);else if(e.__resizeTrigger__){var r=e.__resizeTrigger__.contentDocument,a=r&&r.defaultView;a&&(a.removeEventListener("resize",o),delete a.__resizeTrigger__),e.__resizeTrigger__=!e.removeChild(e.__resizeTrigger__)}delete e.__resizeListeners__}}var r="undefined"==typeof window?t:t.bind(window);r.unbind=i;var n={},a={props:{src:String,alt:String,srcset:String},data:function(){return{isLoaded:!1,isVisible:!1,isInstant:!1}},created:function(){n[this.src]&&(this.isLoaded=!0,this.isVisible=!0)},mounted:function(){var t=this;this.isLoaded||(this._observer_disconnect=function(e,a,t){var i=(2<arguments.length&&void 0!==t?t:{}).delay,o=void 0===i?300:i,c=!0,d=0,h=null,n=new IntersectionObserver(function(e,t){function i(){a({isVisibleOnInit:c,entry:e[0]})}var n=e[0],s=n.time,r=n.isIntersecting;r&&(c?(t.disconnect(),i()):h=setTimeout(function(){d===s&&(t.disconnect(),i())},o)),d=s,c=!1});return n.observe(e),function(){clearTimeout(h),n.disconnect()}}(this.$el,function(e){e.isVisibleOnInit;t.isVisible=!0}))},destroyed:function(){this._observer_disconnect&&this._observer_disconnect()},methods:{onLoad:function(){n[this.src]=!0,this.isLoaded=!0}}};var c,d=function(e,t,i,n,s,r,a,o,c,d){"boolean"!=typeof a&&(c=o,o=a,a=!1);var h,l="function"==typeof i?i.options:i;if(e&&e.render&&(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,s&&(l.functional=!0)),n&&(l._scopeId=n),r?(h=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,c(e)),e&&e._registeredComponents&&e._registeredComponents.add(r)},l._ssrRegister=h):t&&(h=a?function(){t.call(this,d(this.$root.$options.shadowRoot))}:function(e){t.call(this,o(e))}),h)if(l.functional){var g=l.render;l.render=function(e,t){return h.call(t),g(e,t)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,h):[h]}return i},h="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());var l={};function g(e){return function(e,t){return function(e,t){var i=h?t.media||"default":e,n=l[i]||(l[i]={ids:new Set,styles:[]});if(!n.ids.has(e)){n.ids.add(e);var s=t.source;if(t.map&&(s+="\n/*# sourceURL="+t.map.sources[0]+" */",s+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),n.element||(n.element=document.createElement("style"),n.element.type="text/css",t.media&&n.element.setAttribute("media",t.media),void 0===c&&(c=document.head||document.getElementsByTagName("head")[0]),c.appendChild(n.element)),"styleSheet"in n.element)n.styles.push(s),n.element.styleSheet.cssText=n.styles.filter(Boolean).join("\n");else{var r=n.ids.size-1,a=document.createTextNode(s),o=n.element.childNodes;o[r]&&n.element.removeChild(o[r]),o.length?n.element.insertBefore(a,o[r]):n.element.appendChild(a)}}}(e,t)}}function u(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"lazy-image-container",class:{"is-loaded":t.isLoaded},attrs:{"data-masonry-image":""}},[t.isVisible?i("img",{staticClass:"lazy-image",class:{"is-loaded":t.isLoaded,"is-instant":t.isInstant},attrs:{src:t.src,alt:t.alt,srcset:t.srcset},on:{load:function(e){return t.onLoad()}}}):t._e()])}function p(){var i=this,e=i.$createElement,n=i._self._c||e;return n("div",{staticClass:"image-masonry",class:{"is-resizing":i.isResizing}},[n("div",{attrs:{"data-resizer":""}}),i._v(" "),n("div",{staticClass:"image-masonry-container",style:{width:i.width+"px"}},i._l(i.scaledImages,function(t){return n("div",{key:t.src,staticClass:"masonry-item",style:i.makeStyle(t),on:{click:function(e){return i.onClick(t.index,e)}}},[i._t("default",null,{image:t,index:i.index}),i._v(" "),n("lazy-image",{staticClass:"masonry-image",attrs:{src:t.src,alt:t.alt,srcset:t.srcset}})],2)}),0)])}function f(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("image-masonry",{attrs:{images:this.images}})],1)}var j=a,x=(u._withStripped=!0,d({render:u,staticRenderFns:[]},function(e){e&&e("data-v-480b240c_0",{source:".lazy-image-container[data-v-480b240c] {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  background: rgba(255, 255, 255, 0.1);\r\n  display: block;\n}\n.lazy-image[data-v-480b240c] {\r\n  display: block;\r\n  width: 100%;\r\n  height: 100%;\r\n  opacity: 0;\r\n  transition: opacity 200ms ease-in-out;\n}\n.lazy-image.is-loaded[data-v-480b240c] {\r\n  opacity: 1;\n}\n.lazy-image.is-instant[data-v-480b240c] {\r\n  opacity: 1;\r\n  transition: none;\n}\r\n",map:void 0,media:void 0})},j,"data-v-480b240c",!(u._withStripped=!0),void 0,g,void 0)),E={props:{images:{type:Array,required:!0,default:[]},targetRowHeight:{type:Number,default:220},padding:{type:Number,default:4}},data:function(){return{scaledImages:[],width:0,isResizing:!1}},components:{lazyImage:x},methods:{makeStyle:function(e){var t=e.scaledHeight,i=e.scaledWidth,n=e.isLastInRow,s=e.isLastRow,r=this.padding+"px",a=s?"0":r,o="0 0 ".concat(i,"px");return n&&(r="0",o="1 1 ".concat(i-4,"px")),{height:t+"px",flex:o,"margin-right":r,"margin-bottom":a}},onClick:function(e,t){this.$emit("image-click",this.images[e],e,t)}},mounted:function(){function e(){t.width=t.$el.getBoundingClientRect().width,t.scaledImages=s({images:t.images,containerWidth:t.width,targetHeight:t.targetRowHeight,padding:t.padding})}var t=this,i=this.$el.querySelector("[data-resizer]"),n=function(i,n){var s=null;return function(){clearTimeout(s);var e=arguments,t=this;s=setTimeout(function(){i.apply(t,e)},n)}}(function(){t.isResizing=!1},100);r(i,function(){Math.round(t.width)!==Math.round(i.getBoundingClientRect().width)&&(t.isResizing=!0,e(),n())}),this.$watch("images",function(){e()},{immediate:!0,deep:!0}),this.$watch("targetRowHeight",e)},beforeDestroy:function(){i(this.$el)}},R=(p._withStripped=!0,{data:function(){return{images:e}},components:{imageMasonry:d({render:p,staticRenderFns:[]},function(e){e&&e("data-v-2ca26007_0",{source:".image-masonry[data-v-2ca26007] {\r\n  max-width: 100%;\n}\n.image-masonry.is-resizing[data-v-2ca26007] {\r\n  overflow: hidden;\n}\n.image-masonry-container[data-v-2ca26007] {\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -ms-flex-wrap: wrap;\r\n  flex-wrap: wrap;\n}\n.masonry-item[data-v-2ca26007] {\r\n  position: relative;\n}\n.masonry-image[data-v-2ca26007] {\r\n  display: block;\r\n  width: 100%;\r\n  height: 100%;\n}\n.lazy-image-container[data-v-2ca26007] {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  background: rgba(255, 255, 255, 0.1);\r\n  display: block;\n}\n.lazy-image[data-v-2ca26007] {\r\n  display: block;\r\n  width: 100%;\r\n  height: 100%;\r\n  opacity: 0;\r\n  transition: opacity 200ms ease-in-out;\n}\n.lazy-image.is-loaded[data-v-2ca26007] {\r\n  opacity: 1;\n}\r\n",map:void 0,media:void 0})},E,"data-v-2ca26007",!(p._withStripped=!0),void 0,g,void 0)}});f._withStripped=!0;return d({render:f,staticRenderFns:[]},void 0,R,void 0,!(f._withStripped=!0),void 0,void 0,void 0)});
//# sourceMappingURL=image-masonry-vue.js.map

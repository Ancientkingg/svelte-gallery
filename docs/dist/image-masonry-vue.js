!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).ImageMasonryExample=e()}(this,(function(){"use strict";var t=[{src:"https://source.unsplash.com/V6TWE6h8gyg/800x600",width:800,height:600},{src:"https://source.unsplash.com/dtaPArYUDg4/800x600",width:800,height:600},{src:"https://source.unsplash.com/R_kik2MoltU/600x799",width:600,height:799},{src:"https://source.unsplash.com/8LPgWfHgcMg/600x799",width:600,height:799},{src:"https://source.unsplash.com/mC_puQe4V3g/600x800",width:600,height:800},{src:"https://source.unsplash.com/_LuLiJc1cdo/800x600",width:800,height:600},{src:"https://source.unsplash.com/v7daTKlZzaw/800x599",width:800,height:599},{src:"https://source.unsplash.com/s7qZayMy6Go/600x799",width:600,height:799},{src:"https://source.unsplash.com/rB-4G58XFt0/600x800",width:600,height:800},{src:"https://source.unsplash.com/fg6g2u5oklo/1000x300",width:1e3,height:400},{src:"https://source.unsplash.com/eVwzKfnEGDg/800x600",width:800,height:600},{src:"https://source.unsplash.com/F_eLtGyrlNY/600x800",width:600,height:800},{src:"https://source.unsplash.com/9270-pFGVTU/800x600",width:800,height:600},{src:"https://source.unsplash.com/R4y_E5ZQDPg/800x599",width:800,height:599},{src:"https://source.unsplash.com/-QTa5xYxDCs/800x599",width:800,height:599},{src:"https://source.unsplash.com/Sfs_64L9UHE/600x800",width:600,height:800},{src:"https://source.unsplash.com/pR166OP_l6g/800x600",width:800,height:600},{src:"https://source.unsplash.com/hlvtJ4JkVfc/800x600",width:800,height:600},{src:"https://source.unsplash.com/AUYr7ptqSRQ/800x400",width:800,height:400},{src:"https://source.unsplash.com/E7PlRr9ZfoM/800x600",width:800,height:600},{src:"https://source.unsplash.com/GhlotfzelR4/800x600",width:800,height:600},{src:"https://source.unsplash.com/Xvlc79bu9MA/800x600",width:800,height:600},{src:"https://source.unsplash.com/txRO7-0I8wU/600x800",width:600,height:800},{src:"https://source.unsplash.com/e2uTOpgW5Ec/1000x300",width:1e3,height:300},{src:"https://source.unsplash.com/5BsNkTMbZZ0/800x600",width:800,height:600},{src:"https://source.unsplash.com/_31y-mxvRWI/600x800",width:600,height:800},{src:"https://source.unsplash.com/VrrZAVkzfWE/800x600",width:800,height:600}];const e={single_source_shortest_paths:function(t,e,n){var i={},r={};r[e]=0;var o,h,a,c,d,u,l=new s((function(t){return t.cost}));for(l.push({value:e,cost:0});l.size();)for(var p in h=(o=l.pop()).value,a=o.cost,c=t(h)||{})d=a+c[p],u=r[p],(void 0===r[p]||u>d)&&(r[p]=d,l.push({value:p,cost:d}),i[p]=h);if(void 0===r[n]){var g=["Could not find a path from ",e," to ",n,"."].join("");throw new Error(g)}return i},extract_shortest_path_from_predecessor_list:function(t,e){for(var s=[],n=e;n;)s.push(n),t[n],n=t[n];return s.reverse(),s},find_path:function(t,s,n){var i=e.single_source_shortest_paths(t,s,n);return e.extract_shortest_path_from_predecessor_list(i,n)}};function s(t){this.content=[],this.scoreFunction=t}function n(t,e){return e/t}function i(t,e){return t/e}function r(t,e,s){return function(t,e){return t*e}(e,n(t.reduce((t,{scaledWidth:e})=>t+e,0),s))}function o(t,e,s,n,i){const o=r(t.slice(e,s),n,i);return Math.pow(Math.abs(o-i),2)}function h(t){var e=t.target||t.srcElement;e.__resizeRAF__&&cancelAnimationFrame(e.__resizeRAF__),e.__resizeRAF__=requestAnimationFrame((function(){var s=e.__resizeTrigger__,n=s&&s.__resizeListeners__;n&&n.forEach((function(e){e.call(s,t)}))}))}s.prototype={push:function(t){this.content.push(t),this.bubbleUp(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.sinkDown(0)),t},remove:function(t){for(var e=this.content.length,s=0;s<e;s++)if(this.content[s]===t){var n=this.content.pop();return void(s!==e-1&&(this.content[s]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.bubbleUp(s):this.sinkDown(s)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(t){for(var e=this.content[t];t>0;){var s=Math.floor((t+1)/2)-1,n=this.content[s];if(!(this.scoreFunction(e)<this.scoreFunction(n)))break;this.content[s]=e,this.content[t]=n,t=s}},sinkDown:function(t){for(var e=this.content.length,s=this.content[t],n=this.scoreFunction(s);;){var i=2*(t+1),r=i-1,o=null;if(r<e){var h=this.content[r],a=this.scoreFunction(h);a<n&&(o=r)}if(i<e){var c=this.content[i];this.scoreFunction(c)<(null===o?n:a)&&(o=i)}if(null==o)break;this.content[t]=this.content[o],this.content[o]=s,t=o}}};var a=function(t,e){var s,n=this.document,i=n.attachEvent;if("undefined"!=typeof navigator&&(s=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/)),!t.__resizeListeners__)if(t.__resizeListeners__=[],i)t.__resizeTrigger__=t,t.attachEvent("onresize",h);else{"static"===getComputedStyle(t).position&&(t.style.position="relative");var r=t.__resizeTrigger__=n.createElement("object");r.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),r.setAttribute("class","resize-sensor"),r.setAttribute("tabindex","-1"),r.__resizeElement__=t,r.onload=function(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",h)},r.type="text/html",s&&t.appendChild(r),r.data="about:blank",s||t.appendChild(r)}t.__resizeListeners__.push(e)},c="undefined"==typeof window?a:a.bind(window),d=function(t,e){var s=document.attachEvent,n=t.__resizeListeners__||[];if(e){var i=n.indexOf(e);-1!==i&&n.splice(i,1)}else n=t.__resizeListeners__=[];if(!n.length){if(s)t.detachEvent("onresize",h);else if(t.__resizeTrigger__){var r=t.__resizeTrigger__.contentDocument,o=r&&r.defaultView;o&&(o.removeEventListener("resize",h),delete o.__resizeTrigger__),t.__resizeTrigger__=!t.removeChild(t.__resizeTrigger__)}delete t.__resizeListeners__}};c.unbind=d;var u={props:{images:{type:Array,required:!0,default:[]},targetRowHeight:{type:Number,default:220}},data:()=>({scaledImages:[],width:0}),methods:{makeStyle:({scaledWidthPc:t,scaledHeight:e})=>({width:t+"%",height:e+"px"}),onClick(t,e){this.$emit("image-click",this.images[t],t,e)}},mounted(){const t=()=>{this.width=this.$el.getBoundingClientRect().width,this.scaledImages=function(t,s,h,a=8,c=!1){const d=t.map(t=>{const e=n(t.width,t.height);return{...t,ratio:e,scaledWidth:i(h,e),scaledHeight:h,scaledWidthPc:0}}),u=e.find_path(t=>{const e={};e[t=+t]=0;for(let n=t+1;n<d.length+1&&!(n-t>a);++n)e[""+n]=o(d,t,n,s,h);return e},"0",d.length),l=[],p=[];for(let t=0;t<u.length;t++)if(u[t+1]){const e=d.slice(+u[t],+u[t+1]),n=r(e,s,h);e.forEach(t=>{t.scaledWidth=i(n,t.ratio),t.scaledHeight=n,t.scaledWidthPc=t.scaledWidth/s*100,p.push(t)}),l.push(e)}return c?l:p}(this.images,this.width,this.targetRowHeight)};c(this.$el,()=>{Math.round(this.width)!==Math.round(this.$el.getBoundingClientRect().width)&&t()}),this.$watch("images",()=>{t()},{immediate:!0,deep:!0}),this.$watch("targetRowHeight",t)},beforeDestroy(){d(this.$el)}};var l,p=function(t,e,s,n,i,r,o,h,a,c){"boolean"!=typeof o&&(a=h,h=o,o=!1);var d,u="function"==typeof s?s.options:s;if(t&&t.render&&(u.render=t.render,u.staticRenderFns=t.staticRenderFns,u._compiled=!0,i&&(u.functional=!0)),n&&(u._scopeId=n),r?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,a(t)),t&&t._registeredComponents&&t._registeredComponents.add(r)},u._ssrRegister=d):e&&(d=o?function(){e.call(this,c(this.$root.$options.shadowRoot))}:function(t){e.call(this,h(t))}),d)if(u.functional){var l=u.render;u.render=function(t,e){return d.call(e),l(t,e)}}else{var p=u.beforeCreate;u.beforeCreate=p?[].concat(p,d):[d]}return s},g="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());var m={};var _=function(t){return function(t,e){return function(t,e){var s=g?e.media||"default":t,n=m[s]||(m[s]={ids:new Set,styles:[]});if(!n.ids.has(t)){n.ids.add(t);var i=e.source;if(e.map&&(i+="\n/*# sourceURL="+e.map.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e.map))))+" */"),n.element||(n.element=document.createElement("style"),n.element.type="text/css",e.media&&n.element.setAttribute("media",e.media),void 0===l&&(l=document.head||document.getElementsByTagName("head")[0]),l.appendChild(n.element)),"styleSheet"in n.element)n.styles.push(i),n.element.styleSheet.cssText=n.styles.filter(Boolean).join("\n");else{var r=n.ids.size-1,o=document.createTextNode(i),h=n.element.childNodes;h[r]&&n.element.removeChild(h[r]),h.length?n.element.insertBefore(o,h[r]):n.element.appendChild(o)}}}(t,e)}};const f=u;var v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"image-masonry"},t._l(t.scaledImages,(function(e,n){return s("div",{key:e.src,staticClass:"image-masonry-item",style:t.makeStyle(e),on:{click:function(e){return t.onClick(n,e)}}},[s("img",{attrs:{src:e.src,alt:e.alt}})])})),0)};v._withStripped=!0;const w={data:()=>({images:t}),components:{imageMasonry:p({render:v,staticRenderFns:[]},(function(t){t&&t("data-v-a6dbad7e_0",{source:".image-masonry[data-v-a6dbad7e] {\r\n  box-sizing: border-box;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -ms-flex-wrap: wrap;\r\n  flex-wrap: wrap;\n}\n.image-masonry-item[data-v-a6dbad7e] {\r\n  box-sizing: border-box;\r\n  padding: 1px\n}\n.image-masonry-item img[data-v-a6dbad7e] {\r\n  display: block;\r\n  width: 100%;\r\n  height: 100%;\n}\r\n",map:void 0,media:void 0})}),f,"data-v-a6dbad7e",!1,void 0,_,void 0)},methods:{onChangeImages(){const e=[...t];!function(t){for(let e=t.length-1;e>0;e--){const s=Math.floor(Math.random()*(e+1));[t[e],t[s]]=[t[s],t[e]]}}(e),this.images=e},onChangeRowHeight(){this.targetRowHeight=this.targetRowHeight+20},onClick(...t){console.log(...t)}}};var x=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("button",{attrs:{type:"button"},on:{click:t.onChangeImages}},[t._v("Change images")]),t._v(" "),s("button",{attrs:{type:"button"},on:{click:t.onChangeRowHeight}},[t._v("Change row height")]),t._v(" "),s("image-masonry",{attrs:{images:t.images,targetRowHeight:t.targetRowHeight},on:{"image-click":t.onClick}})],1)};x._withStripped=!0;return p({render:x,staticRenderFns:[]},void 0,w,void 0,!1,void 0,void 0,void 0)}));
//# sourceMappingURL=image-masonry-vue.js.map

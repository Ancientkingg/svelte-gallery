!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).ImageMasonryExample=e()}(this,(function(){"use strict";var t=[{src:"https://source.unsplash.com/V6TWE6h8gyg/800x600",width:800,height:600},{src:"https://source.unsplash.com/dtaPArYUDg4/800x600",width:800,height:600},{src:"https://source.unsplash.com/R_kik2MoltU/600x799",width:600,height:799},{src:"https://source.unsplash.com/8LPgWfHgcMg/600x799",width:600,height:799},{src:"https://source.unsplash.com/mC_puQe4V3g/600x800",width:600,height:800},{src:"https://source.unsplash.com/_LuLiJc1cdo/800x600",width:800,height:600},{src:"https://source.unsplash.com/v7daTKlZzaw/800x599",width:800,height:599},{src:"https://source.unsplash.com/s7qZayMy6Go/600x799",width:600,height:799},{src:"https://source.unsplash.com/rB-4G58XFt0/600x800",width:600,height:800},{src:"https://source.unsplash.com/fg6g2u5oklo/1000x300",width:1e3,height:400},{src:"https://source.unsplash.com/eVwzKfnEGDg/800x600",width:800,height:600},{src:"https://source.unsplash.com/F_eLtGyrlNY/600x800",width:600,height:800},{src:"https://source.unsplash.com/9270-pFGVTU/800x600",width:800,height:600},{src:"https://source.unsplash.com/R4y_E5ZQDPg/800x599",width:800,height:599},{src:"https://source.unsplash.com/-QTa5xYxDCs/800x599",width:800,height:599},{src:"https://source.unsplash.com/Sfs_64L9UHE/600x800",width:600,height:800},{src:"https://source.unsplash.com/pR166OP_l6g/800x600",width:800,height:600},{src:"https://source.unsplash.com/hlvtJ4JkVfc/800x600",width:800,height:600},{src:"https://source.unsplash.com/AUYr7ptqSRQ/800x400",width:800,height:400},{src:"https://source.unsplash.com/E7PlRr9ZfoM/800x600",width:800,height:600},{src:"https://source.unsplash.com/GhlotfzelR4/800x600",width:800,height:600},{src:"https://source.unsplash.com/Xvlc79bu9MA/800x600",width:800,height:600},{src:"https://source.unsplash.com/txRO7-0I8wU/600x800",width:600,height:800},{src:"https://source.unsplash.com/e2uTOpgW5Ec/1000x300",width:1e3,height:300},{src:"https://source.unsplash.com/5BsNkTMbZZ0/800x600",width:800,height:600},{src:"https://source.unsplash.com/_31y-mxvRWI/600x800",width:600,height:800},{src:"https://source.unsplash.com/VrrZAVkzfWE/800x600",width:800,height:600}];const e={single_source_shortest_paths:function(t,e,i){var n={},o={};o[e]=0;var r,h,c,a,u,d,l=new s((function(t){return t.cost}));for(l.push({value:e,cost:0});l.size();)for(var _ in h=(r=l.pop()).value,c=r.cost,a=t(h)||{})u=c+a[_],d=o[_],(void 0===o[_]||d>u)&&(o[_]=u,l.push({value:_,cost:u}),n[_]=h);if(void 0===o[i]){var g=["Could not find a path from ",e," to ",i,"."].join("");throw new Error(g)}return n},extract_shortest_path_from_predecessor_list:function(t,e){for(var s=[],i=e;i;)s.push(i),t[i],i=t[i];return s.reverse(),s},find_path:function(t,s,i){var n=e.single_source_shortest_paths(t,s,i);return e.extract_shortest_path_from_predecessor_list(n,i)}};function s(t){this.content=[],this.scoreFunction=t}function i(t,e){return e/t}function n(t,e){return t/e}function o(t,e,s){return function(t,e){return t*e}(e,i(t.reduce((t,{scaledWidth:e})=>t+e,0),s))}function r(t,e,s,i,n){const r=o(t.slice(e,s),i,n);return Math.pow(Math.abs(r-n),2)}function h(t){var e=t.target||t.srcElement;e.__resizeRAF__&&cancelAnimationFrame(e.__resizeRAF__),e.__resizeRAF__=requestAnimationFrame((function(){var s=e.__resizeTrigger__,i=s&&s.__resizeListeners__;i&&i.forEach((function(e){e.call(s,t)}))}))}s.prototype={push:function(t){this.content.push(t),this.bubbleUp(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.sinkDown(0)),t},remove:function(t){for(var e=this.content.length,s=0;s<e;s++)if(this.content[s]===t){var i=this.content.pop();return void(s!==e-1&&(this.content[s]=i,this.scoreFunction(i)<this.scoreFunction(t)?this.bubbleUp(s):this.sinkDown(s)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(t){for(var e=this.content[t];t>0;){var s=Math.floor((t+1)/2)-1,i=this.content[s];if(!(this.scoreFunction(e)<this.scoreFunction(i)))break;this.content[s]=e,this.content[t]=i,t=s}},sinkDown:function(t){for(var e=this.content.length,s=this.content[t],i=this.scoreFunction(s);;){var n=2*(t+1),o=n-1,r=null;if(o<e){var h=this.content[o],c=this.scoreFunction(h);c<i&&(r=o)}if(n<e){var a=this.content[n];this.scoreFunction(a)<(null===r?i:c)&&(r=n)}if(null==r)break;this.content[t]=this.content[r],this.content[r]=s,t=r}}};var c=function(t,e){var s,i=this.document,n=i.attachEvent;if("undefined"!=typeof navigator&&(s=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/)),!t.__resizeListeners__)if(t.__resizeListeners__=[],n)t.__resizeTrigger__=t,t.attachEvent("onresize",h);else{"static"===getComputedStyle(t).position&&(t.style.position="relative");var o=t.__resizeTrigger__=i.createElement("object");o.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),o.setAttribute("class","resize-sensor"),o.setAttribute("tabindex","-1"),o.__resizeElement__=t,o.onload=function(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",h)},o.type="text/html",s&&t.appendChild(o),o.data="about:blank",s||t.appendChild(o)}t.__resizeListeners__.push(e)},a="undefined"==typeof window?c:c.bind(window),u=function(t,e){var s=document.attachEvent,i=t.__resizeListeners__||[];if(e){var n=i.indexOf(e);-1!==n&&i.splice(n,1)}else i=t.__resizeListeners__=[];if(!i.length){if(s)t.detachEvent("onresize",h);else if(t.__resizeTrigger__){var o=t.__resizeTrigger__.contentDocument,r=o&&o.defaultView;r&&(r.removeEventListener("resize",h),delete r.__resizeTrigger__),t.__resizeTrigger__=!t.removeChild(t.__resizeTrigger__)}delete t.__resizeListeners__}};a.unbind=u;var d=function(t,e,s,i,n,o,r,h,c,a){"boolean"!=typeof r&&(c=h,h=r,r=!1);var u,d="function"==typeof s?s.options:s;if(t&&t.render&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,n&&(d.functional=!0)),i&&(d._scopeId=i),o?(u=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,c(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},d._ssrRegister=u):e&&(u=r?function(){e.call(this,a(this.$root.$options.shadowRoot))}:function(t){e.call(this,h(t))}),u)if(d.functional){var l=d.render;d.render=function(t,e){return u.call(e),l(t,e)}}else{var _=d.beforeCreate;d.beforeCreate=_?[].concat(_,u):[u]}return s};const l={props:{images:{type:Array,required:!0,default:[]},targetRowHeight:{type:Number,default:220}},data:()=>({scaledImages:[],width:0}),methods:{makeStyle:({scaledWidthPc:t,scaledHeight:e})=>({width:t+"%",height:e+"px"}),onClick(t,e){this.$emit("image-click",this.images[t],t,e)}},mounted(){const t=()=>{this.width=this.$el.getBoundingClientRect().width,this.scaledImages=function(t,s,h,c=8,a=!1){const u=t.map(t=>{const e=i(t.width,t.height);return{...t,ratio:e,scaledWidth:n(h,e),scaledHeight:h,scaledWidthPc:0}}),d=e.find_path(t=>{const e={};e[t=+t]=0;for(let i=t+1;i<u.length+1&&!(i-t>c);++i)e[""+i]=r(u,t,i,s,h);return e},"0",u.length),l=[],_=[];for(let t=0;t<d.length;t++)if(d[t+1]){const e=u.slice(+d[t],+d[t+1]),i=o(e,s,h);e.forEach(t=>{t.scaledWidth=n(i,t.ratio),t.scaledHeight=i,t.scaledWidthPc=t.scaledWidth/s*100,_.push(t)}),l.push(e)}return a?l:_}(this.images,this.width,this.targetRowHeight)};a(this.$el,()=>{Math.round(this.width)!==Math.round(this.$el.getBoundingClientRect().width)&&t()}),this.$watch("images",()=>{t()},{immediate:!0,deep:!0}),this.$watch("targetRowHeight",t)},beforeDestroy(){u(this.$el)}};var _=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"image-masonry"},t._l(t.scaledImages,(function(e,i){return s("div",{key:e.src,staticClass:"image-masonry-item",style:t.makeStyle(e),on:{click:function(e){return t.onClick(i,e)}}},[s("img",{attrs:{src:e.src,alt:e.alt}})])})),0)};_._withStripped=!0;const g={data:()=>({images:t}),components:{imageMasonry:d({render:_,staticRenderFns:[]},void 0,l,void 0,!1,void 0,void 0,void 0)},methods:{onChangeImages(){const e=[...t];!function(t){for(let e=t.length-1;e>0;e--){const s=Math.floor(Math.random()*(e+1));[t[e],t[s]]=[t[s],t[e]]}}(e),this.images=e},onChangeRowHeight(){this.targetRowHeight=this.targetRowHeight+20},onClick(...t){console.log(...t)}}};var p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("button",{attrs:{type:"button"},on:{click:t.onChangeImages}},[t._v("Change images")]),t._v(" "),s("button",{attrs:{type:"button"},on:{click:t.onChangeRowHeight}},[t._v("Change row height")]),t._v(" "),s("image-masonry",{attrs:{images:t.images,targetRowHeight:t.targetRowHeight},on:{"image-click":t.onClick}})],1)};p._withStripped=!0;return d({render:p,staticRenderFns:[]},void 0,g,void 0,!1,void 0,void 0,void 0)}));
//# sourceMappingURL=image-masonry-vue.js.map

(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(a=a||self,a.ImageMasonryExample=b())})(this,function(){'use strict';var k=Math.floor;function a(a){this.content=[],this.scoreFunction=a}function b(a,b){return b/a}function c(a,b){return a*b}function d(a,b){return a/b}function e(a,d,e){const f=a.reduce((a,{scaledWidth:b})=>a+b,0);return c(d,b(f,e))}function f(a,b,c,d,f){const g=a.slice(b,c),h=e(g,d,f);return Math.pow(Math.abs(h-f),2)}function g(a,c,g,h=8,i=!1){const j=a.map(a=>{const c=b(a.width,a.height);return{...a,ratio:c,scaledWidth:d(g,c),scaledHeight:g,scaledWidthPc:0}}),k=m.find_path(a=>{const b={};a=+a,b[a]=0;for(let d=a+1;d<j.length+1&&!(d-a>h);++d)b[""+d]=f(j,a,d,c,g);return b},"0",j.length),l=[],n=[];for(let b=0;b<k.length;b++)if(k[b+1]){const a=j.slice(+k[b],+k[b+1]),f=e(a,c,g);a.forEach(a=>{a.scaledWidth=d(f,a.ratio),a.scaledHeight=f,a.scaledWidthPc=100*(a.scaledWidth/c),n.push(a)}),l.push(a)}return i?l:n}function h(a){var b=a.target||a.srcElement;b.__resizeRAF__&&cancelAnimationFrame(b.__resizeRAF__),b.__resizeRAF__=requestAnimationFrame(function(){var c=b.__resizeTrigger__,d=c&&c.__resizeListeners__;d&&d.forEach(function(b){b.call(c,a)})})}function i(a){for(let b=a.length-1;0<b;b--){const c=k(Math.random()*(b+1));[a[b],a[c]]=[a[c],a[b]]}}var l=[{src:"https://source.unsplash.com/V6TWE6h8gyg/800x600",width:800,height:600},{src:"https://source.unsplash.com/dtaPArYUDg4/800x600",width:800,height:600},{src:"https://source.unsplash.com/R_kik2MoltU/600x799",width:600,height:799},{src:"https://source.unsplash.com/8LPgWfHgcMg/600x799",width:600,height:799},{src:"https://source.unsplash.com/mC_puQe4V3g/600x800",width:600,height:800},{src:"https://source.unsplash.com/_LuLiJc1cdo/800x600",width:800,height:600},{src:"https://source.unsplash.com/v7daTKlZzaw/800x599",width:800,height:599},{src:"https://source.unsplash.com/s7qZayMy6Go/600x799",width:600,height:799},{src:"https://source.unsplash.com/rB-4G58XFt0/600x800",width:600,height:800},{src:"https://source.unsplash.com/fg6g2u5oklo/1000x300",width:1e3,height:400},{src:"https://source.unsplash.com/eVwzKfnEGDg/800x600",width:800,height:600},{src:"https://source.unsplash.com/F_eLtGyrlNY/600x800",width:600,height:800},{src:"https://source.unsplash.com/9270-pFGVTU/800x600",width:800,height:600},{src:"https://source.unsplash.com/R4y_E5ZQDPg/800x599",width:800,height:599},{src:"https://source.unsplash.com/-QTa5xYxDCs/800x599",width:800,height:599},{src:"https://source.unsplash.com/Sfs_64L9UHE/600x800",width:600,height:800},{src:"https://source.unsplash.com/pR166OP_l6g/800x600",width:800,height:600},{src:"https://source.unsplash.com/hlvtJ4JkVfc/800x600",width:800,height:600},{src:"https://source.unsplash.com/AUYr7ptqSRQ/800x400",width:800,height:400},{src:"https://source.unsplash.com/E7PlRr9ZfoM/800x600",width:800,height:600},{src:"https://source.unsplash.com/GhlotfzelR4/800x600",width:800,height:600},{src:"https://source.unsplash.com/Xvlc79bu9MA/800x600",width:800,height:600},{src:"https://source.unsplash.com/txRO7-0I8wU/600x800",width:600,height:800},{src:"https://source.unsplash.com/e2uTOpgW5Ec/1000x300",width:1e3,height:300},{src:"https://source.unsplash.com/5BsNkTMbZZ0/800x600",width:800,height:600},{src:"https://source.unsplash.com/_31y-mxvRWI/600x800",width:600,height:800},{src:"https://source.unsplash.com/VrrZAVkzfWE/800x600",width:800,height:600}];const m={single_source_shortest_paths:function(b,c,e){var d={},f={};f[c]=0;var g=new a(function(a){return a.cost});g.push({value:c,cost:0});for(var h,i,j,k,l,m,n,o;g.size();)for(var p in h=g.pop(),i=h.value,j=h.cost,k=b(i)||{},k)l=k[p],m=j+l,n=f[p],o="undefined"==typeof f[p],(o||n>m)&&(f[p]=m,g.push({value:p,cost:m}),d[p]=i);if("undefined"==typeof f[e]){var q=["Could not find a path from ",c," to ",e,"."].join("");throw new Error(q)}return d},extract_shortest_path_from_predecessor_list:function(a,b){for(var c,d=[],e=b;e;)d.push(e),c=a[e],e=a[e];return d.reverse(),d},find_path:function(a,b,c){var d=m.single_source_shortest_paths(a,b,c);return m.extract_shortest_path_from_predecessor_list(d,c)}};a.prototype={push:function(a){this.content.push(a),this.bubbleUp(this.content.length-1)},pop:function(){var a=this.content[0],b=this.content.pop();return 0<this.content.length&&(this.content[0]=b,this.sinkDown(0)),a},remove:function(a){for(var b=this.content.length,c=0;c<b;c++)if(this.content[c]===a){var d=this.content.pop();return void(c!==b-1&&(this.content[c]=d,this.scoreFunction(d)<this.scoreFunction(a)?this.bubbleUp(c):this.sinkDown(c)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(a){for(var b=this.content[a];0<a;){var c=k((a+1)/2)-1,d=this.content[c];if(this.scoreFunction(b)<this.scoreFunction(d))this.content[c]=b,this.content[a]=d,a=c;else break}},sinkDown:function(a){for(var b=this.content.length,c=this.content[a],d=this.scoreFunction(c);;){var e=2*(a+1),f=e-1,g=null;if(f<b){var h=this.content[f],i=this.scoreFunction(h);i<d&&(g=f)}if(e<b){var j=this.content[e],k=this.scoreFunction(j);k<(null===g?d:i)&&(g=e)}if(null!=g)this.content[a]=this.content[g],this.content[g]=c,a=g;else break}}};var n=function(a,b){function c(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",h)}var d,e=this,f=e.document,g=f.attachEvent;if("undefined"!=typeof navigator&&(d=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/)),!a.__resizeListeners__)if(a.__resizeListeners__=[],g)a.__resizeTrigger__=a,a.attachEvent("onresize",h);else{"static"===getComputedStyle(a).position&&(a.style.position="relative");var i=a.__resizeTrigger__=f.createElement("object");i.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),i.setAttribute("class","resize-sensor"),i.setAttribute("tabindex","-1"),i.__resizeElement__=a,i.onload=c,i.type="text/html",d&&a.appendChild(i),i.data="about:blank",d||a.appendChild(i)}a.__resizeListeners__.push(b)},o="undefined"==typeof window?n:n.bind(window),p=function(a,b){var c=document.attachEvent,d=a.__resizeListeners__||[];if(b){var e=d.indexOf(b);-1!==e&&d.splice(e,1)}else d=a.__resizeListeners__=[];if(!d.length){if(c)a.detachEvent("onresize",h);else if(a.__resizeTrigger__){var f=a.__resizeTrigger__.contentDocument,g=f&&f.defaultView;g&&(g.removeEventListener("resize",h),delete g.__resizeTrigger__),a.__resizeTrigger__=!a.removeChild(a.__resizeTrigger__)}delete a.__resizeListeners__}};o.unbind=p;var q={props:{images:{type:Array,required:!0,default:[]},targetRowHeight:{type:Number,default:220}},data:()=>({scaledImages:[],width:0}),methods:{makeStyle({scaledWidthPc:a,scaledHeight:b}){return{width:a+"%",height:b+"px"}},onClick(a,b){this.$emit("image-click",this.images[a],a,b)}},mounted(){const a=()=>{this.width=this.$el.getBoundingClientRect().width,this.scaledImages=g(this.images,this.width,this.targetRowHeight)};o(this.$el,()=>{var b=Math.round;b(this.width)!==b(this.$el.getBoundingClientRect().width)&&a()}),this.$watch("images",()=>{a()},{immediate:!0,deep:!0}),this.$watch("targetRowHeight",a)},beforeDestroy(){p(this.$el)}},r=function(a,b,c,d,e,f,g,h,i,j){"boolean"!=typeof g&&(i=h,h=g,g=!1);var k="function"==typeof c?c.options:c;a&&a.render&&(k.render=a.render,k.staticRenderFns=a.staticRenderFns,k._compiled=!0,e&&(k.functional=!0)),d&&(k._scopeId=d);var l;if(f?(l=function(a){a=a||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,a||"undefined"==typeof __VUE_SSR_CONTEXT__||(a=__VUE_SSR_CONTEXT__),b&&b.call(this,i(a)),a&&a._registeredComponents&&a._registeredComponents.add(f)},k._ssrRegister=l):b&&(l=g?function(){b.call(this,j(this.$root.$options.shadowRoot))}:function(a){b.call(this,h(a))}),l)if(k.functional){var m=k.render;k.render=function(a,b){return l.call(b),m(a,b)}}else{var n=k.beforeCreate;k.beforeCreate=n?[].concat(n,l):[l]}return c};var s=function(){var a=this,b=a.$createElement,c=a._self._c||b;return c("div",{staticClass:"image-masonry"},a._l(a.scaledImages,function(b,d){return c("div",{key:b.src,staticClass:"image-masonry-item",style:a.makeStyle(b),on:{click:function(b){return a.onClick(d,b)}}},[c("img",{attrs:{src:b.src,alt:b.alt}})])}),0)};s._withStripped=!0;var t=r({render:s,staticRenderFns:[]},void 0,q,void 0,!1,void 0,void 0,void 0),u={data:()=>({images:l}),components:{imageMasonry:t},methods:{onChangeImages(){const a=[...l];i(a),this.images=a},onChangeRowHeight(){this.targetRowHeight+=20},onClick(...a){console.log(...a)}}};var v=function(){var a=this,b=a.$createElement,c=a._self._c||b;return c("div",[c("button",{attrs:{type:"button"},on:{click:a.onChangeImages}},[a._v("Change images")]),a._v(" "),c("button",{attrs:{type:"button"},on:{click:a.onChangeRowHeight}},[a._v("Change row height")]),a._v(" "),c("image-masonry",{attrs:{images:a.images,targetRowHeight:a.targetRowHeight},on:{"image-click":a.onClick}})],1)};v._withStripped=!0;var w=r({render:v,staticRenderFns:[]},void 0,u,void 0,!1,void 0,void 0,void 0);return w});
//# sourceMappingURL=image-masonry-vue.js.map
